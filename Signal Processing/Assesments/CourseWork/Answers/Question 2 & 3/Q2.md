
$$\begin{bmatrix} 
−1 & −1 & −1 & −1 & −1 \\
−1 & −1 & −1 & −1 & −1 \\
−1 & −1 & 24 & −1 & −1 \\
−1 & −1 & −1 & −1 & −1 \\
−1 & −1 & −1 & −1 & −1 \\
\end{bmatrix}$$

This kernel highlights pixels by how they differ from pixels in their immediate vicinity, when applied to the brain scan this makes the edges of bright features show up as light lines with darker outlines or the inverse for darker features. 

###### Figure 9: Brain Filter Side By Side

![Brain Filter SideBySide](Brain_Filter_SideBySide.png)

This is done by considering a region of up to 2 pixels in every direction and subtracting the value of each neighbouring pixel from the one at the centre of this region, to compensate the the pixel at the centre is multiplied in magnitude by the number of neighbouring pixels compared against. 
This can be achived by defining the kernel shown above in MATLAB and using teh `conv2` function to perfom a 2D convolution.

```MATLAB
original_image = imread('Brain_BW512x512.png');

kernel = [
  -1 -1 -1 -1 -1;
  -1 -1 -1 -1 -1;
  -1 -1 24 -1 -1;
  -1 -1 -1 -1 -1;
  -1 -1 -1 -1 -1
  ];

filtered_image = conv2(double(original_image), kernel);
filtered_image = uint8(mat2gray(filtered_image) * 255);
```

The filter could be adjusted to only pick up larger features by increasing the size of both the centre and the surroundings considered, or discriminate against a larger region by increasing just the surroundings like shown below.

###### Figure 10: Kernal Size Comparison

![Kernal Size Comparison](Kernal_Size_Comparison.svg)

By changing the centre value we can essentially add this on top of the original image (or an inverted version) with the effect of increasing it's sharpness.

###### Figure 11: Kernal Centre Value Comparison

![](Kernal_Centre_Comparison.svg)

The details of the scripts to generate the two figures above can be found in the annex.